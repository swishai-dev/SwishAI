# Implementation Plan: Basketball AI Prediction Agent (Polymarket REST API)

**Branch**: `002-basketball-polymarket-api` | **Date**: 2026-01-17 | **Spec**: [/specs/002-basketball-polymarket-api/spec.md](spec.md)
**Input**: Feature specification from `/specs/002-basketball-polymarket-api/spec.md`

## Summary

The project will be refactored to exclusively use the Polymarket Gamma REST API for fetching basketball prediction markets. The system will distinguish between "Games" (Matchups) and "Props" (Player/Event specifics), applying a robust keyword-based filter (NBA, EuroLeague, NCAA, etc.) to ensure a basketball-only experience. Data accuracy is the top priority, with a focus on mapping raw Polymarket markets into aggregated Matchup entities and providing AI-driven insights grounded in verified statistics.

## Technical Context

**Language/Version**: TypeScript / Node.js 20+ (Next.js 14/15 App Router)
**Primary Dependencies**: Next.js, OpenAI/Anthropic SDK (AI SDK), Tailwind CSS, Framer Motion, GSAP, Three.js, Prisma, Polymarket Gamma API.
**Storage**: PostgreSQL (via Prisma)
**Testing**: Vitest (Unit/Integration), Playwright (E2E)
**Target Platform**: Web (Vercel / Node.js)
**Project Type**: Next.js fullstack application
**Performance Goals**: API response < 300ms for aggregated markets, Page load < 3s, TTI < 5s.
**Constraints**: Basketball-only markets, Polymarket REST API only (no GraphQL), 0% invented data.
**Scale/Scope**: Support for 100+ active basketball markets across various leagues with real-time odds syncing.

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

**Code Quality**: ✓ Feature design follows single-responsibility principle and maintains code quality standards.
**Testing Standards**: ✓ Test strategy defined (unit for filters, integration for API/Prisma, E2E for Explorer flows).
**User Experience Consistency**: ✓ Dashboard aesthetic follows trading-dashboard guidelines (glassmorphism, neon accents).
**Performance Requirements**: ✓ Optimized fetching with server-side aggregation and caching.
**Technology Stack**: ✓ Next.js App Router; dependencies restricted to essential animation and AI libs.
**File Structure**: ✓ Domain-driven organization (explorer, analysis, shared).
**Responsive Design**: ✓ Mobile-first approach for market rows and betting grids.

## Project Structure

### Documentation (this feature)

```text
specs/002-basketball-polymarket-api/
├── plan.md              # This file
├── research.md          # Phase 0 output
├── data-model.md        # Phase 1 output
├── quickstart.md        # Phase 1 output
├── contracts/           # Phase 1 output
└── tasks.md             # Phase 2 output (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
app/
├── api/
│   ├── markets/         # Aggregated basketball markets (Games/Props)
│   └── analysis/        # AI inference triggered by market data
├── (explorer)/          # Explorer route group
│   ├── explorer/        # Basketball Market Explorer page
│   └── matchup/[id]/    # Individual matchup analysis page
└── layout.tsx

components/
├── explorer/            # MarketRow, PropCard, BettingGrid, Pagination
├── analysis/            # AnalysisReveal, MetricsDisplay
├── shared/              # Hero, Layout components
└── ui/                  # Reusable neon-themed components

lib/
├── data/
│   ├── polymarket.ts    # Polymarket Gamma REST API client & aggregators
│   └── sports-api.ts    # Verified basketball stats (NBA, EuroLeague)
├── ai/
│   └── analyst.ts       # LLM integration for basketball-specific reasoning
└── db.ts                # Prisma client

types/
├── market.ts            # Polymarket & Aggregated market interfaces
└── analysis.ts          # AI report structure

tests/
├── unit/                # Filtering and aggregation logic
├── integration/         # API route and database tests
└── e2e/                 # User journey tests
```

**Structure Decision**: Next.js fullstack application with domain-specific subdirectories under `app/` and `components/`. Logic is encapsulated in `lib/data` to ensure accurate data fetching.

## Complexity Tracking

*No violations of the Constitution identified.*
